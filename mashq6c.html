<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mashq 6 - Krossvord</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/mashq6.css">
    <style>
        .mashq6c-card{max-width:100%;width:100%;padding:36px}
        .main-layout{display:grid;grid-template-columns:1fr auto 1fr;gap:28px;align-items:start}
        .crossword-center{display:flex;flex-direction:column;align-items:center}
        .crossword-grid{display:grid;grid-template-columns:repeat(12,42px);grid-template-rows:repeat(13,42px);gap:2px;width:fit-content}
        .cell{width:42px;height:42px;position:relative}
        .cell.black{background:transparent;pointer-events:none}
        .cell input{width:100%;height:100%;border:2px solid rgba(255,255,255,.15);border-radius:6px;text-align:center;font-size:18px;font-weight:700;font-family:'Nunito',sans-serif;text-transform:uppercase;outline:none;background:rgba(255,255,255,.1);color:#fff;transition:.2s}
        .cell input:focus{border-color:#8338ec;background:rgba(131,56,236,.2);transform:scale(1.06)}
        .cell input.hl{background:rgba(131,56,236,.12);border-color:rgba(131,56,236,.3)}
        .cell input.correct{background:rgba(0,200,83,.25)!important;border-color:#00c853!important;color:#69f0ae!important}
        .cell input.incorrect{background:rgba(255,23,68,.2)!important;border-color:#ff1744!important;color:#ff5252!important}
        .cell input.key-cell{border-color:rgba(234,76,137,.5);background:rgba(234,76,137,.12)}
        .cell input.key-cell:focus{border-color:#ea4c89;background:rgba(234,76,137,.25)}
        .num-badge{position:absolute;top:1px;left:2px;font-size:10px;font-weight:800;color:#fff;width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:10;pointer-events:none;line-height:1}
        .clues-col{flex:1}
        .clues-col h3{font-weight:800;color:#fff;margin-bottom:14px;font-size:1.2em;text-align:center}
        .clue-item{margin-bottom:10px;padding:12px 14px;background:rgba(255,255,255,.06);border-radius:10px;border-left:4px solid #8338ec;font-size:.88rem;color:rgba(255,255,255,.8);line-height:1.45}
        .clue-item b{color:#fff}
        .clues-col.clues-right .clue-item{border-left:none;border-right:4px solid #ea4c89}
        @media(max-width:1100px){
            .main-layout{grid-template-columns:1fr;justify-items:center}
            .crossword-center{order:0}
            .clues-col.clues-left{order:1}
            .clues-col.clues-right{order:2}
            .clues-col{max-width:600px;width:100%}
        }
        @media(max-width:700px){
            .crossword-grid{grid-template-columns:repeat(12,30px);grid-template-rows:repeat(13,30px)}
            .cell{width:30px;height:30px}.cell input{font-size:13px}
            .num-badge{font-size:8px;width:14px;height:14px}
            .mashq6c-card{padding:16px 8px}
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">&larr; Orqaga</a>
    <h1 class="mashq-title">Krossvordni yeching!</h1>
    <div class="quiz-card mashq6-card mashq6c-card">
        <div class="main-layout">
            <div class="clues-col clues-left">
                <h3>Eniga &rarr;</h3>
                <div id="clues-h"></div>
            </div>
            <div class="crossword-center">
                <div class="crossword-grid" id="grid"></div>
                <div class="btn-area">
                    <button class="check-btn" id="check-btn" onclick="checkAnswers()">Tekshirish</button>
                    <button class="retry-btn" id="retry-btn" onclick="retry()">Qayta urinish</button>
                </div>
                <div class="result-msg" id="result"></div>
            </div>
            <div class="clues-col clues-right">
                <h3>Bo'yiga &darr;</h3>
                <div id="clues-v"></div>
            </div>
        </div>
    </div>
<script>
const ROWS=13,COLS=12;
let dir='h';
let focusedCell=null;

const answers={
'0-0':'D','0-1':'E','0-2':'K','0-3':'O','0-4':'R','0-5':'A','0-6':'T','0-7':'I','0-8':'V','0-11':'G',
'1-5':'P','1-11':'A',
'2-5':'P','2-11':'R',
'3-1':'S','3-3':'K','3-5':'L','3-11':'M',
'4-1':'I','4-2':'L','4-3':'O','4-4':'T','4-5':'I','4-6':'N','4-7':'C','4-8':'H','4-9':'A','4-11':'O',
'5-0':'Q','5-1':'M','5-3':'C','5-5':'K','5-11':'N',
'6-0':'O','6-1':'M','6-2':'Y','6-3':'H','6-4':'M','6-5':'A','6-6':'Z','6-7':'M','6-8':'U','6-9':'N','6-10':'L','6-11':'I',
'7-0':'G','7-1':'E','7-2':'O','7-3':'M','7-4':'E','7-5':'T','7-6':'R','7-7':'I','7-8':'K','7-11':'K',
'8-0':'O','8-1':'T','8-2':'P','8-3':'A','8-5':'S','8-11':'A',
'9-0':'Z','9-1':'R','9-2':'I','9-3':'N','9-5':'I',
'10-1':'I','10-2':'S','10-3':'C','10-4':'S','10-5':'Y','10-6':'U','10-7':'J','10-8':'E','10-9':'T','10-10':'L','10-11':'I',
'11-1':'K','11-2':'H','11-3':'H','11-5':'A',
'12-3':'I'
};

const keyCells=new Set(['0-5','1-5','2-5','3-5','4-5','5-5','6-5','7-5','8-5','9-5','10-5','11-5']);

const nums={
'6-4':{n:'1',c:'#1b8a2f'},
'10-4':{n:'2',c:'#7b2ff7'},
'0-0':{n:'3',c:'#e6a817'},
'7-0':{n:'4',c:'#e53935'},
'4-2':{n:'5',c:'#1e88e5'},
'5-0':{n:'6',c:'#1b8a2f'},
'6-2':{n:'7',c:'#1b8a2f'},
'0-11':{n:'8',c:'#1b8a2f'},
'3-3':{n:'9',c:'#e6a817'},
'3-1':{n:'10',c:'#7b2ff7'}
};

// So'z chegaralari: gorizontal [row, startCol, endCol], vertikal [col, startRow, endRow]
const hRanges=[[0,0,8],[4,2,9],[6,4,11],[7,0,8],[10,4,11]];
const vRanges=[[5,0,11],[0,5,9],[1,3,11],[2,6,11],[3,3,12],[11,0,8]];

const hSet=new Set(), vSet=new Set();
hRanges.forEach(function(w){ for(let c=w[1];c<=w[2];c++) hSet.add(w[0]+'-'+c); });
vRanges.forEach(function(w){ for(let r=w[1];r<=w[2];r++) vSet.add(r+'-'+w[0]); });

function has(r,c){ return (r+'-'+c) in answers; }
function getInp(r,c){ return document.querySelector('input[data-row="'+r+'"][data-col="'+c+'"]'); }

function autoDir(r,c){
    var k=r+'-'+c;
    var isH=hSet.has(k), isV=vSet.has(k);
    if(isH&&!isV) return 'h';
    if(isV&&!isH) return 'v';
    return dir;
}

function highlightWord(r,c){
    document.querySelectorAll('.cell input.hl').forEach(function(i){ i.classList.remove('hl'); });
    var k=r+'-'+c;
    var i,w;
    if(dir==='h'){
        for(i=0;i<hRanges.length;i++){
            w=hRanges[i];
            if(w[0]===r && c>=w[1] && c<=w[2]){
                for(var nc=w[1];nc<=w[2];nc++){ var el=getInp(w[0],nc); if(el) el.classList.add('hl'); }
                return;
            }
        }
    }
    if(dir==='v'){
        for(i=0;i<vRanges.length;i++){
            w=vRanges[i];
            if(w[0]===c && r>=w[1] && r<=w[2]){
                for(var nr=w[1];nr<=w[2];nr++){ var el2=getInp(nr,w[0]); if(el2) el2.classList.add('hl'); }
                return;
            }
        }
    }
}

// Grid yaratish
var g=document.getElementById('grid');
for(var r=0;r<ROWS;r++){
    for(var c=0;c<COLS;c++){
        var cell=document.createElement('div');
        cell.className='cell';
        var key=r+'-'+c;
        if(!(key in answers)){
            cell.classList.add('black');
        }else{
            var inp=document.createElement('input');
            inp.type='text'; inp.maxLength=1;
            inp.dataset.row=r; inp.dataset.col=c;
            if(keyCells.has(key)) inp.classList.add('key-cell');
            if(nums[key]){
                var badge=document.createElement('div');
                badge.className='num-badge';
                badge.textContent=nums[key].n;
                badge.style.background=nums[key].c;
                cell.appendChild(badge);
            }
            inp.addEventListener('mousedown',(function(inp){
                return function(){
                    var r2=+inp.dataset.row, c2=+inp.dataset.col;
                    var k=r2+'-'+c2;
                    if(focusedCell===inp && hSet.has(k) && vSet.has(k)){
                        dir=(dir==='h'?'v':'h');
                        highlightWord(r2,c2);
                    }else{
                        dir=autoDir(r2,c2);
                    }
                };
            })(inp));
            inp.addEventListener('focus',(function(inp){
                return function(){
                    focusedCell=inp;
                    highlightWord(+inp.dataset.row,+inp.dataset.col);
                };
            })(inp));
            inp.addEventListener('input',(function(inp){
                return function(){
                    inp.value=inp.value.toUpperCase();
                    if(inp.value){
                        var r2=+inp.dataset.row, c2=+inp.dataset.col;
                        if(dir==='h'){
                            if(has(r2,c2+1)) getInp(r2,c2+1).focus();
                        }else{
                            if(has(r2+1,c2)) getInp(r2+1,c2).focus();
                        }
                    }
                };
            })(inp));
            inp.addEventListener('keydown',(function(inp){
                return function(e){
                    var r2=+inp.dataset.row, c2=+inp.dataset.col;
                    if(e.key==='Backspace'&&!inp.value){
                        e.preventDefault();
                        if(dir==='h'){
                            if(has(r2,c2-1)) getInp(r2,c2-1).focus();
                        }else{
                            if(has(r2-1,c2)) getInp(r2-1,c2).focus();
                        }
                    }
                    if(e.key==='ArrowRight'){ e.preventDefault(); dir='h'; if(has(r2,c2+1)) getInp(r2,c2+1).focus(); else highlightWord(r2,c2); }
                    if(e.key==='ArrowLeft'){ e.preventDefault(); dir='h'; if(has(r2,c2-1)) getInp(r2,c2-1).focus(); else highlightWord(r2,c2); }
                    if(e.key==='ArrowDown'){ e.preventDefault(); dir='v'; if(has(r2+1,c2)) getInp(r2+1,c2).focus(); else highlightWord(r2,c2); }
                    if(e.key==='ArrowUp'){ e.preventDefault(); dir='v'; if(has(r2-1,c2)) getInp(r2-1,c2).focus(); else highlightWord(r2,c2); }
                };
            })(inp));
            cell.appendChild(inp);
        }
        g.appendChild(cell);
    }
}

function checkAnswers(){
    var inputs=document.querySelectorAll('.cell input');
    var total=0,correct=0;
    inputs.forEach(function(inp){
        total++;
        var key=inp.dataset.row+'-'+inp.dataset.col;
        var ok=inp.value.toUpperCase()===answers[key];
        inp.classList.remove('correct','incorrect','hl');
        inp.classList.add(ok?'correct':'incorrect');
        if(ok) correct++;
        inp.disabled=true;
    });
    var res=document.getElementById('result');
    if(correct===total){
        res.textContent="Barakalla! Krossvord to'liq to'g'ri yechildi! Kalit so'z: APPLIKATSIYA";
        res.className='result-msg success';
    }else{
        res.textContent=correct+' / '+total+" ta harf to'g'ri. Qayta urinib ko'ring!";
        res.className='result-msg fail';
    }
    document.getElementById('check-btn').style.display='none';
    document.getElementById('retry-btn').style.display='inline-block';
}

function retry(){
    document.querySelectorAll('.cell input').forEach(function(inp){
        inp.value='';inp.disabled=false;
        inp.classList.remove('correct','incorrect','hl');
    });
    document.getElementById('result').textContent='';
    document.getElementById('result').className='result-msg';
    document.getElementById('check-btn').style.display='inline-block';
    document.getElementById('retry-btn').style.display='none';
    focusedCell=null;
}

// Savollar
document.getElementById('clues-h').innerHTML=
'<div class="clue-item"><b>1.</b> Bu applikatsiyada mazmunli ishlarni yaratish faqat mehnatni emas, balki badiiy tayyorgarlikni ham talab qiladi.</div>'+
'<div class="clue-item"><b>2.</b> Bu applikatsiya kompozitsiyaga ko\'ra oddiy va murakkab bo\'lishi mumkin. Murakkab mazmunli applikatsiya ertaklar, hikoyalar va shu kabilarga illyustrasiya sifatida yasaladi.</div>'+
'<div class="clue-item"><b>3.</b> Bu naqsh gullardan iborat bo\'ladi, u alohida-alohida tasvirlardan tarkib topuvchi predmetli hodisa, harakatlar uyg\'unligini aks ettiruvchi syujetdan iborat bo\'lishi mumkin.</div>'+
'<div class="clue-item"><b>4.</b> Bu applikatsiya bajarilish texnologiyasiga ko\'ra applikatsiyaning eng oddiy turlaridan biri. Geometrik shakllar haqidagi bilimlarni mustahkamlaydi.</div>'+
'<div class="clue-item"><b>5.</b> Applikatsiya qaysi so\'zdan olingan?</div>';

document.getElementById('clues-v').innerHTML=
'<div class="clue-item"><b>6.</b> Applikatsiya usulda qanday materiallardan foydalanib har xil ishlarni bajarish mumkin?</div>'+
'<div class="clue-item"><b>7.</b> Applikatsiya so\'zining ma\'nosi, qirqib olib ....... demakdir.</div>'+
'<div class="clue-item"><b>8.</b> Qog\'ozni 5\u20146 qavat qilib buklab turib qirqishga qanday usuli deyiladi? Bu usulda 1 ta shakl 5\u20146 martaga ko\'payib chiqadi.</div>'+
'<div class="clue-item"><b>9.</b> Applikatsiya bundan 2500 yil muqaddam qaysi xalqlarda paydo bo\'lgan?</div>'+
'<div class="clue-item"><b>10.</b> .......qirqish usuli bilan yaxlit shakl hosil qilinadi va qirqilgan shakl teng va tekis qirqiladi.</div>';

document.getElementById('retry-btn').style.display='none';
</script>
</body>
</html>
